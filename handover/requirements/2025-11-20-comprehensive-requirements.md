# 包括的要件・バグ一覧 - 2025-11-20

**作成日時**: 2025-11-20 17:00
**ステータス**: 網羅的整理完了
**合計残作業時間**: 約18-23時間

---

## 🔴🔴🔴 最優先（緊急・バグ修正）

### 1. コメントメンションの通知機能が正常動作しない **(2時間)**
- **問題点**:
  - メンションした全員がSlack内でメンションされていない
  - メンションしていないのに通知が行くことがある
- **対応**:
  - Slack通知ロジックの調査
  - メンション機能の実装確認
  - テストケースの作成と修正
- **優先度**: 🔴🔴🔴 最優先
- **関連ファイル**: `index-kanban.html` コメント機能部分

### 2. 全データ削除ボタンが機能しなくなっている **(30分)**
- **問題点**: 設定画面の全データ削除ボタンが動作しない
- **対応**:
  - 機能確認
  - Firebase完全移行後のロジック修正
- **優先度**: 🔴🔴🔴 最優先
- **関連ファイル**: `settings.html` または同等機能

### 3. カラムの追加が即時反映されない **(1時間)**
- **問題点**: プロジェクトカラム追加後、画面に即座に反映されない
- **対応**:
  - リアルタイム更新ロジックの確認
  - Firebase onSnapshotの実装確認
  - UI更新トリガーの修正
- **優先度**: 🔴🔴 高
- **関連ファイル**: `pj-settings.html`, `index-kanban.html`

---

## 🔴 高優先度（パフォーマンス・UI改善）

### 4. タスク作成と移動が重い - リファクタリング必要 **(3-5時間)** ⚠️大きな山
- **問題点**:
  - タスク作成時のレスポンスが遅い
  - ドラッグ&ドロップ時に `[Violation] 'drop' handler took 2574ms` 警告
- **対応**:
  - Firebase保存の非同期化
  - 楽観的UI更新の実装
  - 不要な再レンダリングの削除
  - デバウンス・スロットリングの適用
- **優先度**: 🔴 高
- **作業時間**: 3-5時間

### 5. 新規タスクと複数選択ボタンの配置を中央寄りに **(30分)**
- **問題点**: ボタンの配置が使いづらい
- **対応**: CSSレイアウトの調整
- **優先度**: 🔴 高
- **作業時間**: 30分
- **関連ファイル**: `index-kanban.html` CSS部分

### 6. 複数選択の削除機能の動作確認 **(1時間)**
- **質問**:
  - 複数選択での削除は完全に消えている？
  - 削除とゴミ箱が機能混同していないか？
- **対応**:
  - 複数選択削除ロジックの確認
  - ゴミ箱機能との整合性確認
  - 仕様の明確化と修正
- **優先度**: 🔴 高
- **作業時間**: 1時間

### 7. 右上のはてなボタンの機能更新 **(2時間)**
- **問題点**:
  - 現在の機能に対応していないインフォメーションになっている
  - 将来的にマニュアル（使い方）を載せたい
- **対応**:
  - 現在の機能に合わせた情報の更新
  - ユーザーマニュアルの作成と埋め込み
  - ヘルプシステムの設計
- **優先度**: 🔴 高
- **作業時間**: 2時間

---

## 🟡 中優先度（既存要件からの継続）

### 8. LocalStorage完全脱却プロジェクト **(3-5時間)** ⚠️超大きな山

現在132箇所でLocalStorage使用中

| データ | Firebase | LocalStorage | 状態 |
|-------|----------|--------------|------|
| タスク | ✅ | ❌ | 完全移行済み |
| プロジェクト | ✅ | ❌ | 完全移行済み |
| ユーザー情報 | ✅ | ⚠️ キャッシュ | 移行済み |
| currentSession | ❌ | ✅ | **要移行** |
| taskTemplates | ❌ | ✅ | **要移行** |
| projectSettings | ❌ | ✅ | **要移行** |
| kanbanColumns | ❌ | ✅ | **要移行** |
| recurringTemplates | ❌ | ✅ | **要移行** |

### 9. ユーザー追加時のセッション上書き問題 **(1時間)**
- **症状**: ユーザー追加後、自動でそのユーザーにログインされてしまう
- **詳細**:
  - ヘッダーは元のユーザー（邨中天真）のまま
  - マイページは追加したユーザーになる
  - この状態で非表示タスクをチェックすると誰も選択されない
- **対応**: createUser処理でセッションを上書きしないよう修正
- **関連ファイル**: `user-management.html` 745行目付近

### 10. systemUsersのname未定義問題 **(30分)**
- **問題**: 一部ユーザーのnameがundefined
- **対応**: データ整合性チェックと修正

### 11. プロジェクト公開設定の実装 **(30分)**
- **質問**: 機能している？
- **期待**: 他ユーザーへの非表示タスクと同じくらい実現したい
- **対応**:
  1. 機能確認
  2. 実現可能性調査
  3. 実装方法提案

### 12. 管理者ダッシュボードのアクセス権限拡大 **(20分)**
- **要望**: 加藤・朝日（admin権限）にもダッシュボード表示
- **理由**: チームのタスク統計を見れるようにしたい

### 13. メイン画面の統計ロジック確認 **(30分)**
- **質問**: 「要調整」の判定ロジック調査
- **対応**: ロジック調査 → 報告

### 14. マイページの個人詳細統計 **(1時間)**
- **問題**: 機能していない
- **質問**: どういう項目が見れたらいい？タスク完了後の所要時間集計は可能？
- **対応**:
  1. ロジック確認
  2. 機能状況確認
  3. 所要時間集計の実現可能性調査
  4. 推奨項目の提案

### 15. ダッシュボード統計ロジック確認 **(30分)**
- **質問**:
  - 完了したタスクの判別方法は？
  - カラム名変更時の挙動は？
- **対応**: ロジック調査 → 説明

### 16. ユーザー管理の非表示/無効化の違い説明 **(20分)**
- **質問**:
  - 非表示ユーザーと無効化ユーザーの違いは？
  - アプリから直接ユーザー削除でFirebaseにアクセスできない？
- **対応**: 仕様説明 → 改善提案

---

## 🟢 低優先度（調査・意見提示・簡易作業）

### 17. パスワードハードコード問題の解決 **(検討中)**
- **問題**: login.htmlにパスワードがハードコードされている可能性
- **対応**: 削除するか判断が必要

### 18. シークレットタスク実現可能性 **(30分)**
- **質問**:
  - 「このタスクを非表示にする」機能の再検討
  - マルチユーザー前提で、特定タスクを作成者以外に見れなくするのは現実的に可能？
- **対応**:
  1. 技術的実現可能性調査
  2. 実装方法提案
  3. セキュリティ考慮点説明
- **現状**: 非表示タスク機能は実装済み

### 19. 期限日・優先度の必要性 **(20分)**
- **質問**: これらの項目って必要？
- **対応**: 使用状況調査 → 意見提示

### 20. テンプレートカテゴリ必要性確認 **(15分)**
- **質問**: テンプレート管理のカテゴリ設定は要らない？消すべき？
- **対応**: 使用状況調査 → 意見提示

### 21. パスワード変更機能の動作確認 **(15分)** ✅完了
- **質問**: マイページのパスワード変更は機能している？
- **対応**: 機能確認 → 報告

### 22. マイページの管理機能リンク削除 **(5分)** ✅完了
- **意見**: ダッシュボードがハンバーガーにあるから、マイページの管理機能リンクは不要
- **対応**: 削除でOKか確認 → 削除

---

## ⚪ 完了済み（2025-11-20）

- ✅ プロジェクトタスクのDONE/TRASH機能完全実装
- ✅ 完了・ゴミ箱への移動時アラート修正
- ✅ プロジェクト編集モーダルの×ボタン修正
- ✅ 完了カラムの期限切れ表示修正
- ✅ ゴミ箱180日自動削除のプロジェクトタスク対応
- ✅ 管理ID非表示化
- ✅ 本番環境デプロイ
- ✅ 引継ぎ書作成・プッシュ

---

## 📊 優先度別作業時間まとめ

### 🔴🔴🔴 最優先
- コメントメンション通知: 2時間
- 全データ削除ボタン: 30分
- カラム追加即時反映: 1時間
**小計**: 3.5時間

### 🔴 高優先度
- パフォーマンス改善: 3-5時間
- UI配置調整: 30分
- 複数選択削除: 1時間
- はてなボタン更新: 2時間
**小計**: 6.5-8.5時間

### 🟡 中優先度
- LocalStorage脱却: 3-5時間
- その他中優先度: 4.5時間
**小計**: 7.5-9.5時間

### 🟢 低優先度
**小計**: 1.5時間

**総合計**: 約18-23時間

---

## 🎯 推奨作業順序

### フェーズ1: 緊急バグ修正（3.5時間）
1. コメントメンション通知修正
2. 全データ削除ボタン修正
3. カラム追加即時反映修正

### フェーズ2: パフォーマンス改善（6.5-8.5時間）
4. タスク作成・移動のリファクタリング
5. UI配置調整
6. 複数選択削除機能
7. はてなボタン更新

### フェーズ3: 中長期改善（7.5-9.5時間）
8. LocalStorage完全脱却
9. その他中優先度タスク

### フェーズ4: 調査・提案（1.5時間）
10. 低優先度タスク

---

## 📁 関連ファイル

- **メインコード**: `sales-task-core/index-kanban.html`
- **プロジェクト設定**: `sales-task-core/pj-settings.html`
- **ユーザー管理**: `sales-task-core/user-management.html`
- **Firebase設定**: `sales-task-core/firebase-config-auth-fix-20250819-132508.js`
- **本番URL**: https://stellar-biscochitos-e19cb4.netlify.app/sales-task-core/

---

**最終更新**: 2025-11-20 17:00 JST
