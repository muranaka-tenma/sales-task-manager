# Kanban Work - TODO一覧

**バージョン**: v010
**作成日**: 2025-12-11
**最終更新**: 2025-12-11
**合計残作業時間**: 約8-13時間

---

## ⚠️ 次回セッション開始時の必読事項

### 必ず確認すべきファイル
1. **このファイル（TODO-v010）** - 最新の正式版
2. **エラーログ（error-logs/）** - 過去のミスと再発防止策
3. **設計書（design/, handover/design/）** - 未実装機能の設計

### 開発環境URL（重要）
```
開発環境: http://localhost:3000/index-kanban.html
本番環境: https://stellar-biscochitos-e19cb4.netlify.app/sales-task-core/index-kanban.html
```
※ 開発環境に `sales-task-core/` は不要！

---

## ✅ 完了済み

### 2025-12-11 完了（午後セッション）
- ✅ **TERRAブランディング適用**
  - メインカラーを#00AEBBに統一
  - TERRAロゴ追加（白色・背景透過PNG）
  - カラバリ機能を完全削除（テーマCSS/JS全削除）
  - カラム設定にTERRAカラープリセット追加
- ✅ **ボタン色統一**
  - 新規タスク: #00C9B7（明るめティール）
  - 複数選択: #0097A7（深めティール）
- ✅ **レガシーコード削除（54行削減）**
  - `migrateProjectsToFirebase()` 削除
  - `checkLocalStorageProjects()` 削除
  - `loadTasksFromStorage()` 削除
  - `createPeriodicBackup()` + setInterval 削除
  - デバッグ用グローバル公開削除
  - OCR関連コメント削除
- ✅ **楽観的UI更新実装（パフォーマンス改善）**
  - ドラッグ&ドロップ時のFirebase保存を非同期化
  - タスク作成/編集時のFirebase保存を非同期化
  - UIが即座に反映されるように改善
- ✅ **×ボタンの視認性改善** - 全モーダルで灰色背景+ボーダー追加

### 2025-12-11 完了（午前セッション）
- ✅ **タスク作成時のアニメーション** - 新規タスクが3秒間拡大+青い影でハイライト表示
- ✅ **統計サマリーのカード化** - カード型デザイン、グラデーション背景、ホバー効果
- ✅ **期限切れ・今日期限カードのクリック機能** - タスク一覧モーダル表示
- ~~✅ **カラムヘッダーにミニプログレスバー**~~ → ユーザー判断で削除

### 2025-12-09 完了
- ✅ **プロジェクトカラム移動ボタン不具合修正** - 右クリックメニュー対応
- ✅ **Slack通知のカラム名表示修正** - `getColumnNameById()`のprojectId解析修正
- ✅ **タスク作成モーダル改善**
- ✅ **ハンバーガーメニューのログ削除**
- ✅ **プロジェクト一覧にタイムスタンプ表示**
- ✅ **マイページの個人詳細統計修正**

### 2025-12-08以前 完了
- ✅ 「ゴミ箱」→「アーカイブ」リネーム
- ✅ 「営業タスク管理」→「Kanban Work」に変更
- ✅ OCR機能完全削除
- ✅ ヘルプモーダル実装
- ✅ kanbanColumns Firestore移行完了
- ✅ プロジェクトタスク増殖バグ修正
- ✅ Firebase認証・ログイン問題解決
- ✅ E2Eテスト実装（Playwright）

---

## 🔴🔴🔴 最優先（至上命題）

### 1. LocalStorage完全脱却プロジェクト **(3-5時間)**

**ユーザーコメント**: 「至上命題です。超重要です。」
**⚠️ 注意**: これまでエラーが多かった箇所のため、他のタスクを先に片付けてから最後に対応すること。

| データ | Firebase | LocalStorage | 状態 |
|-------|----------|--------------|------|
| タスク | ✅ | ❌ | 完全移行済み |
| プロジェクト | ✅ | ❌ | 完全移行済み |
| ユーザー情報 | ✅ | ⚠️ キャッシュ | 移行済み |
| kanbanColumns | ✅ | ⚠️ キャッシュ | 移行済み（12/08） |
| currentSession | ❌ | ✅ | **要移行** |
| taskTemplates | ❌ | ✅ | **要移行** |
| recurringTemplates | ❌ | ✅ | **要移行** |

---

## 🔴 高優先度

### ~~2. タスク作成と移動が重い~~ ✅ 完了（2025-12-11）
- 楽観的UI更新を実装
- Firebase保存を非同期化（awaitなし）
- UIが即座に反映されるように改善

### ~~3. ユーザー追加時のセッション上書き問題~~ ❌ 放棄
- Firebase Authの仕様上、フロントエンドだけでは防止不可
- Firebase Admin SDK導入時に再検討

### 4. ユーザーごとカラムカスタマイズ **(大規模・要検証)**
- **初出**: v008（2025-12-08）
- **設計書**: `design/user-column-customization-2025-12-08.md`
- 各ユーザーが自分専用のカラム構成を設定
- 「全員」表示時は固定3カラム（未完了一覧・完了・アーカイブ）

---

## 🟡 中優先度

### 5. チュートリアル機能の完成 **(2-3時間)**
- **初出**: v009（2025-12-09）
- ヘルプモーダルは実装済みだが内容の充実が必要
- 最後に対応予定

---

## 📋 延期・保留

### カラムシステム再設計
- **設計書**: `design/column-system-redesign-2025-12-02.md`
- **状態**: 設計完了、実装延期
- **実装タイミング**: カラム名変更で統計が壊れる問題が発生した時
- **現状の保護**: パターンマッチで認識（isDoneColumn, isTrashColumn）

---

## 📊 作業時間見積もり

| 優先度 | 時間 |
|-------|------|
| 🔴🔴🔴 最優先（至上命題） | 3-5時間 |
| 🔴 高優先度（ユーザーカラム） | 3-5時間 |
| 🟡 中優先度 | 2-3時間 |
| **総合計** | **約8-13時間** |

---

## ⚠️ デプロイフロー

1. **開発環境でテスト**: `http://localhost:3000/index-kanban.html`
2. **ユーザーのGOを待つ**
3. **本番デプロイ**: `git push origin main`

---

## 📁 関連ファイル

### コード
- **メインコード**: `sales-task-core/index-kanban.html`（13,361行）
- **マイページ**: `sales-task-core/my-profile.html`
- **Firebase設定**: `sales-task-core/firebase-config-auth-fix-20250819-132508.js`
- **Slack通知**: `sales-task-core/slack-proxy.js`
- **TERRAロゴ**: `sales-task-core/terra-logo-white.png`

### 設計書
- `design/column-system-redesign-2025-12-02.md` - カラムシステム再設計
- `design/user-column-customization-2025-12-08.md` - ユーザーカラムカスタマイズ

### エラーログ
- `error-logs/2025-12-08-ocr-feature-removal.md`
- `error-logs/2025-12-08-trash-to-archive-rename.md`
- `error-logs/2025-12-04-project-task-duplication-fix.md`
- `error-logs/2025-12-04-wrong-dev-url-repeated-mistake.md`
- `error-logs/2025-12-02-statistics-logic-column-detection-fix.md`

---

## バージョン履歴

| バージョン | 日付 | 主な変更 |
|-----------|------|---------|
| v001-v003 | 11/19-20 | 初期要件定義 |
| v004 | 11/20 | 包括的要件定義（22項目） |
| v005 | 12/01 | UI/UX Phase 1完了 |
| v006 | 12/01-02 | ユーザーフィードバック反映、統計ロジック修正 |
| v007 | 12/04 | タスク増殖バグ修正、カラム保護強化 |
| v008 | 12/08 | アーカイブ化、Kanban Work命名、ヘルプ実装 |
| v009 | 12/09 | 全タスク棚卸し、設計書未実装分追加 |
| **v010** | **12/11** | **TERRAブランディング、楽観的UI更新、レガシーコード削除** |

---

**最終更新**: 2025-12-11
**作成者**: Claude Code
**ステータス**: ✅ 最新版
