# Kanban Work - TODO一覧

**バージョン**: v015
**作成日**: 2025-12-16
**最終更新**: 2025-12-16
**ステータス**: 復旧作業継続中

---

## 最重要: 次のエージェントへの引き継ぎ

### 必ず最初に読むファイル
1. **このファイル (TODO-v015)**
2. **error-logs/2025-12-16-session-handover-critical.md**
3. **error-logs/2025-12-15-git-checkout-disaster.md**

### 絶対に守ること
1. **破壊的gitコマンド禁止**: `git checkout --`, `git reset --hard`, `git clean -fd`, `git push --force`
2. **変更したらすぐコミット**
3. **セッション開始時にTODO/エラーログを全て読む**

---

## 現在の進捗（2025-12-16 v015時点）

### 完了（27/36）
| # | 項目 | 完了日 |
|---|------|--------|
| 1 | 統計ロジック14箇所修正（isDoneColumn/isTrashColumn） | 12/16 |
| 2 | TERRAブランディング色調整（#026aa7→#0097A7） | 12/16 |
| 3 | 楽観的UI更新実装（ドラッグ&ドロップ、タスク作成） | 12/16 |
| 4 | 統計カードに完了率・期限遵守率追加 | 12/16 |
| 5 | プロジェクトタスク増殖バグ修正 | 12/16 |
| 6 | 分析サマリーバー重複削除 | 12/16 |
| 7 | APP_VERSION更新（v2-recovery-phase2） | 12/16 |
| 8 | Phase 1: 命名・コメント統一（ゴミ箱→アーカイブ13箇所） | 12/16 |
| 9 | Phase 2: UI/UX改善（絵文字削除30箇所以上） | 12/16 |
| 10 | Phase 3: TERRAブランディング（Base64ロゴ埋め込み） | 12/16 |
| 11 | Phase 4: kanbanColumns Firestore移行（getColumns/saveColumns復旧） | 12/16 |
| 12 | Phase 4: OCR完全削除（残存コード削除） | 12/16 |
| 13 | Phase 5: マイページ統計postMessage修正 | 12/16 |
| 14 | Phase 6: ハンバーガーメニューログ削除 | 12/16 |
| 15 | 加藤・朝日のadmin権限設定（コード内設定済み） | 12/16 |
| 16 | テキストインポートメニュー名称変更 | 12/16 |
| 17 | APP_VERSION更新（v5-columns-firestore） | 12/16 |
| **18** | **プロジェクトカラー選択の視覚的フィードバック** | **12/16** |
| **19** | **サイドバーでプロジェクトカラー反映** | **12/16** |
| **20** | **旧青色#0079bf→TERRA色#0097A7一括変更** | **12/16** |
| **21** | **アーカイブカラム重複防止ロジック** | **12/16** |
| **22** | **アーカイブカラムのグレー点線削除** | **12/16** |
| **23** | **タスク保存後モーダルが閉じない問題修正** | **12/16** |
| **24** | **統計モーダルから編集時にモーダルを閉じる** | **12/16** |
| **25** | **プロジェクト選択と非表示の相互排他** | **12/16** |
| **26** | **デフォルト期限設定反映修正** | **12/16** |
| **27** | **カラム設定「色:」ラベル削除** | **12/16** |

### 現在のコード状態
```javascript
const APP_VERSION = '2025-12-16-v6-ui-fixes';
```

---

## 残りタスク（9項目）

### 高優先度（機能・バグ修正）

| # | 項目 | 詳細 | リスク |
|---|------|------|--------|
| 1 | ユーザー管理・管理者ダッシュボード表示速度改善 | 読み込みが遅い | 中 |
| 2 | カラムカスタマイズバグ修正 | v011の3バグ（作成後更新必要、他者表示で消える、フルネーム更新必要） | **高** |
| 3 | カラム削除時タスクチェック | 他ユーザータスク除外 | 高 |
| 4 | 統計フィルター連動 | 表示対象切替時に統計更新 | 中 |

### 中優先度（UI/UX改善）

| # | 項目 | 詳細 | リスク |
|---|------|------|--------|
| 5 | ヘルプモーダル | タブ切替、スポットライトチュートリアル | 中 |
| 6 | ユーザーごとカラムカスタマイズ | users/{userId}/settings/columns | 中 |
| 7 | ログイン時自動表示対象設定 | Firestore users取得 | 低 |

### 低優先度（クリーンアップ）

| # | 項目 | 詳細 | リスク |
|---|------|------|--------|
| 8 | レガシーコード削除 | migrateProjectsToFirebase等54行 | 低 |
| 9 | 権限修正 | 加藤・朝日をFirestoreでadminに設定 | 低 |

---

## ユーザーからの追加要望（未対応）

| # | 要望 | ステータス |
|---|------|-----------|
| 1 | 右サイドパネルのユーザー管理・管理者ダッシュボード表示速度改善 | 調査中 |
| 2 | タスク作成後「続けてタスクを作成」ボタン追加 | 未着手 |
| 3 | プロジェクト作成時アーカイブカラム削除不可 | 要確認（isRequiredColumn動作確認） |

---

## LocalStorage完全脱却（至上命題）

| データ | Firebase | LocalStorage | 状態 |
|-------|----------|--------------|------|
| タスク | OK | 不使用 | 完全移行済み |
| プロジェクト | OK | 不使用 | 完全移行済み |
| ユーザー情報 | OK | キャッシュ | 移行済み |
| kanbanColumns | OK | キャッシュ | 移行済み |
| defaultDeadlineDays | 未実装 | OK | **要移行** |
| defaultDeadlineTime | 未実装 | OK | **要移行** |
| currentSession | 未実装 | OK | **要移行** |
| taskTemplates | 未実装 | OK | **要移行** |
| recurringTemplates | 未実装 | OK | **要移行** |

---

## 開発環境

```
開発環境: http://localhost:3000/index-kanban.html
本番環境: https://stellar-biscochitos-e19cb4.netlify.app/sales-task-core/index-kanban.html
```

**注意**: 開発環境に `sales-task-core/` は不要！

---

## 関連ファイル

### コード
- `sales-task-core/index-kanban.html` - メインコード
- `sales-task-core/pj-settings.html` - プロジェクト設定
- `sales-task-core/firebase-config-auth-fix-20250819-132508.js` - Firebase設定

### 設計書（復旧時の参照用）
- `design/column-system-redesign-2025-12-02.md` - カラムシステム再設計
- `design/user-column-customization-2025-12-08.md` - ユーザーカラムカスタマイズ

### エラーログ（必読）
- `error-logs/2025-12-16-requirements-validation-success.md` - 要件検証完了
- `error-logs/2025-12-16-session-handover-critical.md` - セッション引き継ぎ
- `error-logs/2025-12-15-git-checkout-disaster.md` - 12/15災害

---

## バージョン履歴

| バージョン | 日付 | 主な内容 |
|-----------|------|---------|
| v001-v003 | 11/19-20 | 初期要件定義 |
| v004 | 11/20 | 包括的要件定義（22項目） |
| v005 | 12/01 | UI/UX Phase 1完了 |
| v006 | 12/01-02 | 統計ロジック修正（14箇所） |
| v007 | 12/04 | タスク増殖バグ修正 |
| v008 | 12/08 | OCR削除、ヘルプモーダル、kanbanColumns移行 |
| v009 | 12/09 | マイページ統計修正 |
| v010 | 12/11 | TERRAブランディング、楽観的UI更新 |
| v011 | 12/15 | ユーザーごとカラムカスタマイズ |
| v012 | 12/15 | リバート後の至上命題まとめ |
| v013 | 12/15 | git checkout災害後の復旧計画 |
| v014 | 12/16 | 復旧進捗17/36、要件検証完了、実装計画策定 |
| **v015** | **12/16** | **復旧進捗27/36、UI/UX改善10項目完了** |

---

**最終更新**: 2025-12-16
**作成者**: Claude Code
**ステータス**: 復旧作業継続中（27/36完了 = 75%）
**次のタスク**: ユーザー管理表示速度改善、カラムカスタマイズバグ修正
