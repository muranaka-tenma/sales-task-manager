<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘¤ ãƒã‚¤ãƒšãƒ¼ã‚¸ - å–¶æ¥­ã‚¿ã‚¹ã‚¯ç®¡ç†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f4f5f7;
            color: #172b4d;
            min-height: 100vh;
        }
        
        .header {
            background: var(--theme-color, #026aa7);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-title {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .back-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .profile-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .profile-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            background: var(--theme-color, #026aa7);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 600;
        }
        
        .profile-info {
            flex: 1;
        }
        
        .profile-name {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .profile-role {
            color: #666;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }
        
        .profile-email {
            color: #666;
            font-size: 0.9rem;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #172b4d;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .action-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .action-card:hover {
            border-color: var(--theme-color, #026aa7);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }
        
        .action-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        .action-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .action-desc {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .stats-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .stat-item {
            text-align: center;
            padding: 1rem;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--theme-color, #026aa7);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .admin-section {
            background: #fff3e0;
            border: 1px solid #ffcc02;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .admin-section .section-title {
            color: #e65100;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="header-title">ğŸ‘¤ ãƒã‚¤ãƒšãƒ¼ã‚¸</h1>
    </div>
    
    <div class="container">
        <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ± -->
        <div class="profile-card">
            <div class="profile-header">
                <div class="profile-avatar" id="profile-avatar">-</div>
                <div class="profile-info">
                    <div class="profile-name" id="profile-name">ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼</div>
                    <div class="profile-role" id="profile-role">æœªãƒ­ã‚°ã‚¤ãƒ³</div>
                    <div class="profile-email" id="profile-email">-</div>
                </div>
            </div>
        </div>
        
        <!-- å€‹äººã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="section-title">âš™ï¸ å€‹äººè¨­å®š</div>
        <div class="action-grid">
            <div class="action-card" onclick="changePassword()">
                <div class="action-icon">ğŸ”</div>
                <div class="action-title">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</div>
                <div class="action-desc">ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¾ã™</div>
            </div>
        </div>
        
        <!-- å€‹äººè©³ç´°çµ±è¨ˆ -->
        <div class="stats-section">
            <div class="section-title">ğŸ“Š å€‹äººè©³ç´°çµ±è¨ˆ</div>
            
            <!-- æœŸé–“é¸æŠ -->
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; padding: 1rem; background: #f7fafc; border-radius: 8px;">
                <span style="font-weight: 600;">æœŸé–“:</span>
                <button class="period-btn" onclick="showPersonalAnalyticsForPeriod('all')" style="padding: 0.5rem 1rem; background: #e2e8f0; border: none; border-radius: 4px; cursor: pointer;">å…¨æœŸé–“</button>
                <button class="period-btn" onclick="showPersonalAnalyticsForPeriod('today')" style="padding: 0.5rem 1rem; background: #e2e8f0; border: none; border-radius: 4px; cursor: pointer;">ä»Šæ—¥</button>
                <button class="period-btn active" onclick="showPersonalAnalyticsForPeriod('week')" style="padding: 0.5rem 1rem; background: #026aa7; color: white; border: none; border-radius: 4px; cursor: pointer;">ä»Šé€±</button>
                <button class="period-btn" onclick="showPersonalAnalyticsForPeriod('month')" style="padding: 0.5rem 1rem; background: #e2e8f0; border: none; border-radius: 4px; cursor: pointer;">ä»Šæœˆ</button>
            </div>
            
            <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold;" id="my-total-tasks">-</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">ç·ã‚¿ã‚¹ã‚¯æ•°</div>
                </div>
                <div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold;" id="my-completion-rate">-</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">å®Œäº†ç‡</div>
                </div>
                <div style="background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold;" id="my-deadline-compliance">-</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">æœŸé™éµå®ˆç‡</div>
                </div>
                <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #333; padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <div style="font-size: 2rem; font-weight: bold;" id="my-avg-completion-time">-</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;">å¹³å‡å®Œäº†æ™‚é–“</div>
                </div>
            </div>
            
            <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©³ç´° -->
            <div id="personal-performance-details" style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-top: 1rem;">
                <!-- è©³ç´°æƒ…å ±ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
            </div>
        </div>
        
        <!-- é–‹ç™ºè€…å°‚ç”¨æ©Ÿèƒ½ -->
        <div class="admin-section" id="developer-section" style="display: none;">
            <div class="section-title">âš™ï¸ é–‹ç™ºè€…æ©Ÿèƒ½</div>
            <div class="action-grid">
                <div class="action-card" onclick="showSystemInfo()">
                    <div class="action-icon">ğŸ”§</div>
                    <div class="action-title">ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</div>
                    <div class="action-desc">ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ãƒ»æŠ€è¡“æƒ…å ±</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKèª­ã¿è¾¼ã¿ -->
    <script type="module" src="firebase-config.js"></script>

    <script>
        // ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ï¼ˆãƒ¡ã‚¤ãƒ³ç”»é¢ã¨åŒã˜é–¢æ•°ï¼‰
        function getCurrentUser() {
            try {
                const session = JSON.parse(localStorage.getItem('currentSession') || 'null');
                if (session && session.user) {
                    return {
                        name: session.user.name,
                        email: session.user.email,
                        role: session.user.role,
                        isLoggedIn: true
                    };
                }
            } catch (error) {
                console.error('ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
            }
            return {
                name: null,
                email: null,
                role: null,
                isLoggedIn: false
            };
        }
        
        // èªè¨¼ãƒã‚§ãƒƒã‚¯ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆç”¨ï¼‰
        function checkAuthentication() {
            const currentUser = getCurrentUser();
            if (!currentUser.isLoggedIn) {
                window.location.href = 'login.html';
                return null;
            }
            return currentUser;
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', () => {
            const currentUser = checkAuthentication();
            if (!currentUser) return;
            
            updateProfileInfo(currentUser);
            loadPersonalStats(currentUser);
            
            // é–‹ç™ºè€…å°‚ç”¨æ©Ÿèƒ½
            if (currentUser.role === 'developer') {
                document.getElementById('developer-section').style.display = 'block';
            }
            
            // URLãƒãƒƒã‚·ãƒ¥ãŒ#development-logã®å ´åˆã€æ©Ÿèƒ½æ”¹å–„æ›¸ã‚’è‡ªå‹•ã§é–‹ã
            if (window.location.hash === '#development-log' && currentUser.role === 'developer') {
                setTimeout(() => {
                    showDevelopmentLog();
                }, 500);
            }
            
        });
        
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã®æ›´æ–°
        function updateProfileInfo(user) {
            document.getElementById('profile-avatar').textContent = user.name ? user.name.charAt(0) : '-';
            document.getElementById('profile-name').textContent = user.name || 'ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼';
            document.getElementById('profile-email').textContent = user.email || '-';
            
            let roleText = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼';
            if (user.role === 'developer') roleText = 'é–‹ç™ºè€…';
            else if (user.role === 'admin') roleText = 'ç®¡ç†è€…';
            document.getElementById('profile-role').textContent = roleText;
        }
        
        // å€‹äººè©³ç´°çµ±è¨ˆã®èª­ã¿è¾¼ã¿
        function loadPersonalStats(user) {
            try {
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ä»Šé€±ã®çµ±è¨ˆã‚’è¡¨ç¤º
                calculatePersonalAnalytics(user, 'week');
            } catch (error) {
                console.error('çµ±è¨ˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // æœŸé–“é¸æŠãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
        function showPersonalAnalyticsForPeriod(period) {
            const currentUser = checkAuthentication();
            if (!currentUser) return;
            
            // ã™ã¹ã¦ã®ãƒœã‚¿ãƒ³ã‹ã‚‰activeã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.style.background = '#e2e8f0';
                btn.style.color = '#333';
            });
            
            // ã‚¯ãƒªãƒƒã‚¯ã—ãŸãƒœã‚¿ãƒ³ã«activeã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
            event.target.style.background = '#026aa7';
            event.target.style.color = 'white';
            
            // æœŸé–“ã«å¿œã˜ã¦åˆ†æã‚’å†è¨ˆç®—
            calculatePersonalAnalytics(currentUser, period);
        }
        
        // å€‹äººçµ±è¨ˆã®è¨ˆç®—
        function calculatePersonalAnalytics(user, period = 'all') {
            try {
                const tasks = JSON.parse(localStorage.getItem('salesTasksKanban') || '[]');
                
                // è‡ªåˆ†ãŒæ‹…å½“è€…ã«ãªã£ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ã‚’æŠ½å‡º
                let myTasks = tasks.filter(task => 
                    task.assignees && task.assignees.includes(user.name)
                );
                
                // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const now = new Date();
                const startOfToday = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                
                if (period === 'today') {
                    myTasks = myTasks.filter(task => {
                        if (task.createdAt) {
                            const createdDate = new Date(task.createdAt);
                            return createdDate >= startOfToday;
                        }
                        return false;
                    });
                } else if (period === 'week') {
                    const startOfWeek = new Date(startOfToday);
                    startOfWeek.setDate(startOfToday.getDate() - startOfToday.getDay());
                    myTasks = myTasks.filter(task => {
                        if (task.createdAt) {
                            const createdDate = new Date(task.createdAt);
                            return createdDate >= startOfWeek;
                        }
                        return false;
                    });
                } else if (period === 'month') {
                    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
                    myTasks = myTasks.filter(task => {
                        if (task.createdAt) {
                            const createdDate = new Date(task.createdAt);
                            return createdDate >= startOfMonth;
                        }
                        return false;
                    });
                }
                
                // çµ±è¨ˆè¨ˆç®—
                const totalTasks = myTasks.length;
                const completedTasks = myTasks.filter(task => task.columnId === 'done');
                const pendingTasks = myTasks.filter(task => task.columnId !== 'done' && task.columnId !== 'trash');
                
                // å®Œäº†ç‡
                const completionRate = totalTasks > 0 ? Math.round((completedTasks.length / totalTasks) * 100) : 0;
                
                // æœŸé™éµå®ˆç‡è¨ˆç®—
                const tasksWithDeadlines = completedTasks.filter(task => task.deadline);
                let onTimeCompletions = 0;
                let totalCompletionTime = 0; // åˆ†å˜ä½
                
                tasksWithDeadlines.forEach(task => {
                    const deadline = new Date(task.deadline);
                    // å®Œäº†æ—¥ã¯æ›´æ–°æ—¥æ™‚ã‹ã‚‰æ¨å®šï¼ˆå®Ÿéš›ã®å®Œäº†æ—¥æ™‚ãŒãªã„å ´åˆï¼‰
                    const completedAt = task.updatedAt ? new Date(task.updatedAt) : new Date();
                    
                    if (completedAt <= deadline) {
                        onTimeCompletions++;
                    }
                    
                    // å¹³å‡å®Œäº†æ™‚é–“è¨ˆç®—ï¼ˆä½œæˆæ—¥ã‹ã‚‰å®Œäº†æ—¥ã¾ã§ï¼‰
                    if (task.createdAt) {
                        const createdAt = new Date(task.createdAt);
                        const completionTimeMs = completedAt - createdAt;
                        totalCompletionTime += Math.max(0, completionTimeMs / (1000 * 60 * 60 * 24)); // æ—¥å˜ä½
                    }
                });
                
                const deadlineCompliance = tasksWithDeadlines.length > 0 ? 
                    Math.round((onTimeCompletions / tasksWithDeadlines.length) * 100) : 0;
                
                const avgCompletionTime = tasksWithDeadlines.length > 0 ? 
                    (totalCompletionTime / tasksWithDeadlines.length).toFixed(1) : 0;
                
                // UIæ›´æ–°
                document.getElementById('my-total-tasks').textContent = totalTasks;
                document.getElementById('my-completion-rate').textContent = completionRate + '%';
                document.getElementById('my-deadline-compliance').textContent = deadlineCompliance + '%';
                document.getElementById('my-avg-completion-time').textContent = avgCompletionTime + 'æ—¥';
                
                // è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º
                const detailsDiv = document.getElementById('personal-performance-details');
                detailsDiv.innerHTML = `
                    <h4 style="margin: 0 0 1rem 0; color: #172b4d;">ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©³ç´°</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div>
                            <div style="font-weight: 600; color: #666; margin-bottom: 0.5rem;">ã‚¿ã‚¹ã‚¯çŠ¶æ³</div>
                            <div>å®Œäº†: ${completedTasks.length}ä»¶</div>
                            <div>é€²è¡Œä¸­: ${pendingTasks.length}ä»¶</div>
                            <div>PJã‚¿ã‚¹ã‚¯: ${myTasks.filter(t => t.isProjectTask).length}ä»¶</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: #666; margin-bottom: 0.5rem;">æœŸé™ç®¡ç†</div>
                            <div>æœŸé™ä»˜ãã‚¿ã‚¹ã‚¯: ${tasksWithDeadlines.length}ä»¶</div>
                            <div>æœŸé™å†…å®Œäº†: ${onTimeCompletions}ä»¶</div>
                            <div>é…å»¶å®Œäº†: ${tasksWithDeadlines.length - onTimeCompletions}ä»¶</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: #666; margin-bottom: 0.5rem;">åŠ¹ç‡æ€§</div>
                            <div>å¹³å‡å®Œäº†æ™‚é–“: ${avgCompletionTime}æ—¥</div>
                            <div>æœŸé™éµå®ˆç‡: ${deadlineCompliance}%</div>
                            <div>å®Œäº†ç‡: ${completionRate}%</div>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('å€‹äººçµ±è¨ˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
        async function changePassword() {
            const currentUser = checkAuthentication();
            if (!currentUser) return;

            const currentPassword = prompt('ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (!currentPassword) return;

            const newPassword = prompt('æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (!newPassword || newPassword.length < 4) {
                alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯4æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const confirmPassword = prompt('æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†åº¦å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (newPassword !== confirmPassword) {
                alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“');
                return;
            }

            // Firebaseèªè¨¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°ã‚’è©¦è¡Œ
            try {
                if (window.FirebaseAuth && window.FirebaseAuth.updatePassword) {
                    console.log('ğŸ” Firebase ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°ã‚’é–‹å§‹...');
                    const result = await window.FirebaseAuth.updatePassword(currentPassword, newPassword);

                    if (result.success) {
                        // Firebaseãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°æˆåŠŸ â†’ LocalStorageã‚‚åŒæœŸ
                        console.log('âœ… Firebase ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°æˆåŠŸ');

                        // LocalStorageã®systemUsersã‚‚åŒæœŸæ›´æ–°
                        const users = JSON.parse(localStorage.getItem('systemUsers') || '[]');
                        const user = users.find(u => u.email === currentUser.email);
                        if (user) {
                            user.password = newPassword;
                            localStorage.setItem('systemUsers', JSON.stringify(users));
                            console.log('âœ… LocalStorage ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚‚åŒæœŸæ›´æ–°');
                        }

                        alert('âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£å¸¸ã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸ');
                    } else {
                        // Firebaseæ›´æ–°å¤±æ•— â†’ ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
                        console.error('âŒ Firebase ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°å¤±æ•—:', result.error);

                        if (result.error.includes('wrong-password') || result.error.includes('invalid-credential')) {
                            alert('âŒ ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
                        } else {
                            alert('âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + result.error);
                        }
                    }
                } else {
                    // FirebaseãŒåˆ©ç”¨ã§ããªã„å ´åˆã¯LocalStorageã®ã¿æ›´æ–°ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
                    console.warn('âš ï¸ FirebaseæœªåˆæœŸåŒ–ã€LocalStorageã®ã¿æ›´æ–°ã—ã¾ã™');

                    const users = JSON.parse(localStorage.getItem('systemUsers') || '[]');
                    const user = users.find(u => u.email === currentUser.email);

                    if (!user || user.password !== currentPassword) {
                        alert('ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
                        return;
                    }

                    user.password = newPassword;
                    localStorage.setItem('systemUsers', JSON.stringify(users));
                    alert('âš ï¸ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸï¼ˆLocalStorageã®ã¿ï¼‰\næ¬¡å›ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã¯Firebaseãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã”ä½¿ç”¨ãã ã•ã„');
                }
            } catch (error) {
                console.error('âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã‚¨ãƒ©ãƒ¼:', error);
                alert('âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
            }
        }
        
        // æ©Ÿèƒ½æ”¹å–„æ›¸è¡¨ç¤ºï¼ˆé–‹ç™ºè€…å°‚ç”¨ï¼‰
        function showDevelopmentLog() {
            // æ—¢å­˜ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒã‚ã‚Œã°å‰Šé™¤
            const existingModal = document.getElementById('developmentLogModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const existingLog = localStorage.getItem('developmentLog') || '';
            
            const logModal = document.createElement('div');
            logModal.id = 'developmentLogModal';
            logModal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);
                z-index: 1000; display: flex; align-items: center; justify-content: center; padding: 2rem;
            `;
            
            logModal.innerHTML = `
                <div style="background: white; border-radius: 12px; width: 100%; max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <div style="padding: 2rem; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                        <h2 style="margin: 0; color: #172b4d;">ğŸ“ æ©Ÿèƒ½æ”¹å–„æ›¸</h2>
                        <button onclick="closeDevelopmentLog()" 
                                style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666; padding: 0.5rem;">Ã—</button>
                    </div>
                    <div style="padding: 2rem;">
                        <div style="margin-bottom: 1.5rem;">
                            <h4 style="color: #666; margin-bottom: 0.5rem;">ğŸ’¡ ä½¿ç”¨æ–¹æ³•</h4>
                            <p style="color: #888; font-size: 0.9rem; line-height: 1.5;">
                                â€¢ è¦ä»¶ã‚„æ”¹å–„å†…å®¹ã‚’è¨˜éŒ²<br>
                                â€¢ ã‚»ãƒƒã‚·ãƒ§ãƒ³åœæ­¢æ™‚ã®çŠ¶æ³ãƒ¡ãƒ¢<br>
                                â€¢ æ¬¡å›é–‹ç™ºæ™‚ã®å¼•ãç¶™ãäº‹é …<br>
                                â€¢ æ©Ÿèƒ½è¿½åŠ ãƒ»ä¿®æ­£å±¥æ­´
                            </p>
                        </div>
                        <textarea id="devLogContent" placeholder="é–‹ç™ºãƒ¡ãƒ¢ãƒ»è¦ä»¶ãƒ»æ”¹å–„ãƒ­ã‚°ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„..."
                                  style="width: 100%; height: 300px; padding: 1rem; border: 1px solid #ddd; border-radius: 8px; 
                                         font-family: monospace; font-size: 0.9rem; resize: vertical;">${existingLog}</textarea>
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button onclick="saveDevelopmentLog()" 
                                    style="padding: 0.75rem 1.2rem; background: #026aa7; color: white; border: none; 
                                           border-radius: 8px; cursor: pointer; font-size: 0.85rem;">
                                ğŸ’¾ ä¿å­˜
                            </button>
                            <button onclick="addManualDeployRecord()" 
                                    style="padding: 0.75rem 1.2rem; background: #17a2b8; color: white; border: none; 
                                           border-radius: 8px; cursor: pointer; font-size: 0.85rem;">
                                ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²
                            </button>
                            <button onclick="autoUpdateDeployHistory()" 
                                    style="padding: 0.75rem 1.2rem; background: #20c997; color: white; border: none; 
                                           border-radius: 8px; cursor: pointer; font-size: 0.85rem;">
                                ğŸ”„ è‡ªå‹•æ›´æ–°
                            </button>
                            <button onclick="generateHandoverSummary()" 
                                    style="padding: 0.75rem 1.2rem; background: #fd7e14; color: white; border: none; 
                                           border-radius: 8px; cursor: pointer; font-size: 0.85rem;">
                                ğŸ“‹ å¼•ãç¶™ã
                            </button>
                            <button onclick="exportDevelopmentLog()" 
                                    style="padding: 0.75rem 1.2rem; background: #28a745; color: white; border: none; 
                                           border-radius: 8px; cursor: pointer; font-size: 0.85rem;">
                                ğŸ“„ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                            </button>
                            <button onclick="clearDevelopmentLog()" 
                                    style="padding: 0.75rem 1.2rem; background: #dc3545; color: white; border: none; 
                                           border-radius: 8px; cursor: pointer; font-size: 0.85rem;">
                                ğŸ—‘ï¸ ã‚¯ãƒªã‚¢
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(logModal);
        }
        
        // æ©Ÿèƒ½æ”¹å–„æ›¸ã‚’é–‰ã˜ã‚‹
        function closeDevelopmentLog() {
            const modal = document.getElementById('developmentLogModal');
            if (modal) {
                modal.remove();
            }
        }
        
        // é–‹ç™ºãƒ­ã‚°ä¿å­˜
        function saveDevelopmentLog() {
            const content = document.getElementById('devLogContent').value;
            const timestamp = new Date().toLocaleString('ja-JP');
            const logEntry = `[${timestamp}] æ‰‹å‹•ä¿å­˜\n${content}\n\n`;
            
            localStorage.setItem('developmentLog', content);
            localStorage.setItem('developmentLogHistory', 
                (localStorage.getItem('developmentLogHistory') || '') + logEntry
            );
            
            alert('ğŸ“ æ©Ÿèƒ½æ”¹å–„æ›¸ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }
        
        // ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²ã®è‡ªå‹•è¿½åŠ 
        function addDeploymentRecord(commitMsg, remainingTasks) {
            const timestamp = new Date().toLocaleString('ja-JP');
            const deployRecord = `
=== ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ² [${timestamp}] ===
ã‚³ãƒŸãƒƒãƒˆå†…å®¹: ${commitMsg}

æ®‹ã‚Šã‚¿ã‚¹ã‚¯:
${remainingTasks}

æ¬¡å›é–‹ç™ºäºˆå®š:
- (ã“ã“ã«æ¬¡å›ã®é–‹ç™ºäºˆå®šã‚’è¨˜å…¥)

---

`;
            
            const currentHistory = localStorage.getItem('developmentLogHistory') || '';
            localStorage.setItem('developmentLogHistory', deployRecord + currentHistory);
            
            // æ©Ÿèƒ½æ”¹å–„æ›¸ã«ã‚‚è‡ªå‹•æ›´æ–°
            const currentLog = localStorage.getItem('developmentLog') || '';
            const updatedLog = `æœ€æ–°ãƒ‡ãƒ—ãƒ­ã‚¤: ${timestamp}\n${commitMsg}\n\n${currentLog}`;
            localStorage.setItem('developmentLog', updatedLog);
        }
        
        // ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²æ‰‹å‹•è¿½åŠ 
        function addManualDeployRecord() {
            const commitMsg = prompt('ä»Šå›ã®ãƒ‡ãƒ—ãƒ­ã‚¤å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (!commitMsg) return;
            
            const remainingTasks = prompt('æ®‹ã‚Šã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (æ”¹è¡Œã¯ \\n ã§åŒºåˆ‡ã‚‹):');
            if (remainingTasks === null) return;
            
            const formattedTasks = remainingTasks.replace(/\\n/g, '\n- ');
            addDeploymentRecord(commitMsg, '- ' + formattedTasks);
            
            alert('ğŸ“ ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²ã‚’è¿½åŠ ã—ã¾ã—ãŸ');
            
            // æ©Ÿèƒ½æ”¹å–„æ›¸ãŒé–‹ã„ã¦ã„ã‚‹å ´åˆã¯æ›´æ–°
            const logContent = document.getElementById('devLogContent');
            if (logContent) {
                logContent.value = localStorage.getItem('developmentLog') || '';
            }
        }
        
        // è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤å±¥æ­´æ›´æ–°æ©Ÿèƒ½
        function autoUpdateDeployHistory() {
            const now = new Date();
            const timestamp = now.toLocaleString('ja-JP');
            
            // å…·ä½“çš„ãªæœ€æ–°ãƒ‡ãƒ—ãƒ­ã‚¤å†…å®¹ï¼ˆå®Ÿéš›ã®ä½œæ¥­ã‚’åæ˜ ï¼‰
            const recentDeployments = [
                'ğŸ¨ è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«UIå¤§å¹…æ”¹å–„ - ã‚»ã‚¯ã‚·ãƒ§ãƒ³åŒºåˆ‡ã‚Šã¨ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼è©³ç´°åŒ–',
                'ğŸ”§ ãƒã‚¤ãƒšãƒ¼ã‚¸JavaScriptæ§‹æ–‡ã‚¨ãƒ©ãƒ¼ä¿®æ­£',
                'ğŸ”§ èªè¨¼é€£æºã¨OCRæ—¥ä»˜è¨ˆç®—ã‚’æ ¹æœ¬ä¿®æ­£',
                'â° OCRæœŸé™è¨­å®šæ”¹å–„ - ä»Šæ—¥+3æ™‚é–“ï¼†æ™‚é–“å…¥åŠ›å¯¾å¿œ',
                'ğŸ§¹ æ©Ÿèƒ½é‡è¤‡æ•´ç† - è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã‹ã‚‰åˆ†æãƒ¬ãƒãƒ¼ãƒˆå‰Šé™¤'
            ];
            
            // å…·ä½“çš„ãªæ®‹ã‚Šè¦ä»¶ãƒªã‚¹ãƒˆ
            const currentRequirements = [
                'ãƒ¢ãƒã‚¤ãƒ«ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆå¯¾å¿œã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å®Ÿè£…',
                'ã‚¿ã‚¹ã‚¯ä¸€æ‹¬æ“ä½œæ©Ÿèƒ½ï¼ˆè¤‡æ•°é¸æŠâ†’ç§»å‹•ãƒ»å‰Šé™¤ãƒ»æ‹…å½“è€…å¤‰æ›´ï¼‰',
                'ç¹°ã‚Šè¿”ã—ã‚¿ã‚¹ã‚¯æ©Ÿèƒ½ï¼ˆæ—¥æ¬¡ãƒ»é€±æ¬¡ãƒ»æœˆæ¬¡ã®è‡ªå‹•ç”Ÿæˆï¼‰',
                'ã‚¿ã‚¹ã‚¯æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã®å¼·åŒ–',
                'ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆCSVãƒ»Excelãƒ»PDFï¼‰',
                'ã‚¿ã‚¹ã‚¯ã®ä¾å­˜é–¢ä¿‚è¨­å®šï¼ˆå‰ã®ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã«é–‹å§‹ï¼‰',
                'ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼é–“ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥æ©Ÿèƒ½',
                'ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ æ©Ÿèƒ½ï¼ˆé¡§å®¢åãƒ»é‡‘é¡ãƒ»åˆ†é¡ç­‰ï¼‰',
                'ã‚¿ã‚¹ã‚¯ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ»å±¥æ­´ç®¡ç†æ©Ÿèƒ½',
                'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆ1000ä»¶ä»¥ä¸Šã®ã‚¿ã‚¹ã‚¯å¯¾å¿œï¼‰'
            ];
            
            const latestDeployment = recentDeployments[0];
            const remainingItems = currentRequirements.map(item => `- ${item}`).join('\n');
            
            // ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²ã‚’è¿½åŠ 
            addDeploymentRecord(latestDeployment, remainingItems);
            
            // æ©Ÿèƒ½æ”¹å–„æ›¸ã®å†…å®¹ã‚’è‡ªå‹•æ›´æ–°
            const autoUpdateContent = `
=== ğŸ”„ è‡ªå‹•æ›´æ–° ${timestamp} ===

ğŸš€ æœ€æ–°ãƒ‡ãƒ—ãƒ­ã‚¤ä¸€è¦§:
${recentDeployments.map(deploy => `âœ… ${deploy}`).join('\n')}

ğŸ“Š ç¾åœ¨ã®å®Œæˆæ©Ÿèƒ½:
âœ… ã‚¿ã‚¹ã‚¯ç®¡ç†ï¼ˆKanbanãƒœãƒ¼ãƒ‰ï¼‰- ã‚«ãƒ©ãƒ è‡ªç”±è¨­å®š
âœ… PJã‚¿ã‚¹ã‚¯ç®¡ç†ï¼ˆæ‰¿èªãƒ•ãƒ­ãƒ¼ä»˜ãï¼‰
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ç®¡ç†ï¼ˆdeveloper > admin > userï¼‰
âœ… è©³ç´°çµ±è¨ˆãƒ»åˆ†ææ©Ÿèƒ½ï¼ˆå€‹äººãƒ»å…¨ä½“ï¼‰
âœ… OCRæ–‡å­—èªè­˜ï¼ˆæ—¥æ™‚è‡ªå‹•è¨­å®šï¼‰
âœ… ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆæ©Ÿèƒ½æ•´ç†æ¸ˆã¿ï¼‰
âœ… ãƒã‚¤ãƒšãƒ¼ã‚¸ï¼ˆçµ±è¨ˆãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ï¼‰
âœ… æ©Ÿèƒ½æ”¹å–„æ›¸ï¼ˆé–‹ç™ºè€…ç”¨ï¼‰
âœ… è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆè¦‹ã‚„ã™ãåŒºåˆ‡ã‚Šæ¸ˆã¿ï¼‰

ğŸ“‹ å…·ä½“çš„ãªæ®‹ã‚Šè¦ä»¶ï¼ˆå„ªå…ˆåº¦é †ï¼‰:
${remainingItems}

ğŸ’¡ æ¬¡å›ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¨å¥¨å¯¾å¿œé †åº:
1. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼‰
2. ã‚¿ã‚¹ã‚¯ä¸€æ‹¬æ“ä½œæ©Ÿèƒ½
3. æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½å¼·åŒ–

=== æ›´æ–°å®Œäº† ===

`;
            
            // æ—¢å­˜ã®å†…å®¹ã¨çµåˆ
            const existingLog = localStorage.getItem('developmentLog') || '';
            const updatedLog = autoUpdateContent + existingLog;
            localStorage.setItem('developmentLog', updatedLog);
            
            // ç”»é¢ã«åæ˜ 
            const logContent = document.getElementById('devLogContent');
            if (logContent) {
                logContent.value = updatedLog;
            }
            
            alert('ğŸ”„ ãƒ‡ãƒ—ãƒ­ã‚¤å±¥æ­´ã¨è¦ä»¶ã‚’è‡ªå‹•æ›´æ–°ã—ã¾ã—ãŸï¼\n\næ–°ã—ã„è¦ä»¶ã‚„æ”¹å–„äº‹é …ãŒã‚ã‚Œã°è¿½è¨˜ã—ã¦ãã ã•ã„ã€‚');
        }
        
        // å¼•ãç¶™ãç”¨ã‚µãƒãƒªãƒ¼ç”Ÿæˆ
        function generateHandoverSummary() {
            const timestamp = new Date().toLocaleString('ja-JP');
            const history = localStorage.getItem('developmentLogHistory') || '';
            const currentLog = localStorage.getItem('developmentLog') || '';
            
            const summary = `# å–¶æ¥­ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ„ãƒ¼ãƒ« - é–‹ç™ºå¼•ãç¶™ãã‚µãƒãƒªãƒ¼
ç”Ÿæˆæ—¥æ™‚: ${timestamp}

## ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
- URL: https://stellar-biscochitos-e19cb4.netlify.app/sales-task-core/index-kanban.html  
- æŠ€è¡“: HTML/CSS/JavaScript (Vanilla), Netlify, LocalStorage
- æ¨©é™: developer(å…¨æ¨©é™) > admin(ç®¡ç†) > user(åŸºæœ¬)

## ğŸ“¦ ä¸»è¦æ©Ÿèƒ½ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
âœ… ã‚¿ã‚¹ã‚¯ç®¡ç† (Kanbanãƒœãƒ¼ãƒ‰æ–¹å¼)
âœ… PJã‚¿ã‚¹ã‚¯ç®¡ç† (æ‰¿èªãƒ•ãƒ­ãƒ¼ä»˜ã)
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ç®¡ç† (3æ®µéš)
âœ… è©³ç´°çµ±è¨ˆãƒ»åˆ†ææ©Ÿèƒ½
âœ… OCRæ–‡å­—èªè­˜ (Tesseract.js)
âœ… ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—é€šçŸ¥
âœ… ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼
âœ… ãƒã‚¤ãƒšãƒ¼ã‚¸ (å€‹äººçµ±è¨ˆãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´)
âœ… æ©Ÿèƒ½æ”¹å–„æ›¸ (é–‹ç™ºè€…å°‚ç”¨)

## ğŸ”§ æœ€è¿‘ã®å®Ÿè£…å†…å®¹
${history ? history.split('===').slice(0, 3).join('===') : 'è¨˜éŒ²ãªã—'}

## ğŸ“ ç¾åœ¨ã®é–‹ç™ºãƒ¡ãƒ¢
${currentLog || 'è¨˜éŒ²ãªã—'}

## ğŸš€ æ¬¡å›é–‹ç™ºè€…ã¸ã®æŒ‡ç¤º
1. ã“ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦æ©Ÿèƒ½æ”¹å–„æ›¸ã«è²¼ã‚Šä»˜ã‘
2. æ–°ã—ã„è¦ä»¶ã‚„ä¿®æ­£ãŒå¿…è¦ãªç®‡æ‰€ãŒã‚ã‚Œã°è¿½è¨˜
3. ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã¯ã€ŒğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²ã€ãƒœã‚¿ãƒ³ã§å±¥æ­´ã‚’æ›´æ–°

## ğŸ”‘ é‡è¦ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ 
- salesTasksKanban: ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿
- systemUsers: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
- currentSession: ãƒ­ã‚°ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³  
- developmentLog: é–‹ç™ºãƒ¡ãƒ¢

## ğŸ¯ æ¨å¥¨é–‹ç™ºãƒ•ãƒ­ãƒ¼
1. æ©Ÿèƒ½æ”¹å–„æ›¸ã§ç¾çŠ¶ç¢ºèª
2. è¦ä»¶ãƒ»æ”¹å–„ç‚¹ã‚’ãƒ¡ãƒ¢ã«è¨˜éŒ²
3. å®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆ
4. ãƒ‡ãƒ—ãƒ­ã‚¤è¨˜éŒ²ã§å±¥æ­´æ›´æ–°
5. æ¬¡å›é–‹ç™ºäºˆå®šã‚’è¨˜è¼‰`;

            // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
            navigator.clipboard.writeText(summary).then(() => {
                alert('ğŸ“‹ å¼•ãç¶™ãã‚µãƒãƒªãƒ¼ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\\n\\næ¬¡ã®é–‹ç™ºè€…ãŒã‚¹ãƒ ãƒ¼ã‚ºã«ç¶™ç¶šã§ãã¾ã™ã€‚');
            }).catch(() => {
                // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ãŒä½¿ãˆãªã„å ´åˆã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const blob = new Blob([summary], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `å¼•ãç¶™ãã‚µãƒãƒªãƒ¼_${timestamp.replace(/[:/]/g, '-')}.txt`;
                a.click();
                URL.revokeObjectURL(url);
                alert('ğŸ“‹ å¼•ãç¶™ãã‚µãƒãƒªãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼');
            });
        }
        
        // é–‹ç™ºãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportDevelopmentLog() {
            const content = document.getElementById('devLogContent').value;
            const history = localStorage.getItem('developmentLogHistory') || '';
            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
            
            const exportData = `# æ©Ÿèƒ½æ”¹å–„æ›¸ - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ\nç”Ÿæˆæ—¥æ™‚: ${new Date().toLocaleString('ja-JP')}\n\n## ç¾åœ¨ã®å†…å®¹\n${content}\n\n## å±¥æ­´\n${history}`;
            
            const blob = new Blob([exportData], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æ©Ÿèƒ½æ”¹å–„æ›¸_${timestamp}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // é–‹ç™ºãƒ­ã‚°ã‚¯ãƒªã‚¢
        function clearDevelopmentLog() {
            if (confirm('æ©Ÿèƒ½æ”¹å–„æ›¸ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆå±¥æ­´ã¯ä¿æŒã•ã‚Œã¾ã™ï¼‰')) {
                document.getElementById('devLogContent').value = '';
                localStorage.removeItem('developmentLog');
                alert('ğŸ—‘ï¸ æ©Ÿèƒ½æ”¹å–„æ›¸ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            }
        }
        
        // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±è¡¨ç¤ºï¼ˆé–‹ç™ºè€…å°‚ç”¨ï¼‰
        function showSystemInfo() {
            const deployInfo = `
ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±

ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ:
â€¢ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: HTML/CSS/JavaScript (Vanilla)
â€¢ ãƒ‡ãƒ—ãƒ­ã‚¤: Netlify (GitHubé€£æº)  
â€¢ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: LocalStorage
â€¢ èªè¨¼: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:
â€¢ Chart.js (çµ±è¨ˆã‚°ãƒ©ãƒ•)
â€¢ Tesseract.js (OCRæ©Ÿèƒ½)
â€¢ Material Icons
â€¢ Web Notifications API

ğŸŒ ãƒ‡ãƒ—ãƒ­ã‚¤æƒ…å ±:
â€¢ æœ¬ç•ªURL: https://stellar-biscochitos-e19cb4.netlify.app/sales-task-core/index-kanban.html
â€¢ ãƒªãƒã‚¸ãƒˆãƒª: GitHubè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤

ğŸ“¦ ä¸»è¦æ©Ÿèƒ½:
â€¢ ã‚¿ã‚¹ã‚¯ç®¡ç† (Kanbanæ–¹å¼)
â€¢ PJã‚¿ã‚¹ã‚¯ç®¡ç†
â€¢ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ç®¡ç† (developer/admin/user)
â€¢ è©³ç´°çµ±è¨ˆãƒ»åˆ†æ
â€¢ OCRæ–‡å­—èªè­˜
â€¢ é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 

ğŸ”‘ æ¨©é™ãƒ¬ãƒ™ãƒ«:
â€¢ developer(3): å…¨æ¨©é™ + é–‹ç™ºæ©Ÿèƒ½
â€¢ admin(2): ç®¡ç†æ©Ÿèƒ½ + ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
â€¢ user(1): åŸºæœ¬æ©Ÿèƒ½ã®ã¿

ğŸ’¾ ãƒ‡ãƒ¼ã‚¿æ§‹é€ :
â€¢ salesTasksKanban: ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿
â€¢ systemUsers: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
â€¢ currentSession: ãƒ­ã‚°ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³
â€¢ developmentLog: é–‹ç™ºãƒ¡ãƒ¢

æœ€çµ‚æ›´æ–°: ${new Date().toLocaleString('ja-JP')}
            `;
            
            alert(deployInfo);
        }
    </script>
</body>
</html>