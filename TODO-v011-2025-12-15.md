# Kanban Work - TODO一覧

**バージョン**: v011
**作成日**: 2025-12-15
**最終更新**: 2025-12-15
**合計残作業時間**: 約6-10時間

---

## ⚠️ 次回セッション開始時の必読事項

### 必ず確認すべきファイル
1. **このファイル（TODO-v011）** - 最新の正式版
2. **エラーログ（error-logs/）** - 過去のミスと再発防止策
3. **設計書（design/, handover/design/）** - 未実装機能の設計

### 開発環境URL（重要）
```
開発環境: http://localhost:3000/index-kanban.html
本番環境: https://stellar-biscochitos-e19cb4.netlify.app/sales-task-core/index-kanban.html
```
※ 開発環境に `sales-task-core/` は不要！

---

## 🔴 未解決のカラム問題（2025-12-15）

| # | 問題 | 状態 |
|---|------|------|
| 1 | カラム作成後、画面更新しないと追加されない | ❌ 未解決 |
| 2 | 他者表示に切り替えると追加したカラムが表示されるが、ログインし直すと消える | ❌ 未解決 |
| 3 | フルネーム表示対象だとカラム変更に画面更新が必要 | ❌ 未解決 |

**次のアクション**: 1つずつ集中的に修正

---

## ✅ 完了済み

### 2025-12-15 完了
- ✅ **ユーザーごとカラムカスタマイズ実装**
  - Firestore `users/{userId}/settings/columns` にカラム設定保存
  - 各ユーザーが独自のカラム構成を持てるように
  - LocalStorageキャッシュをユーザーID別に分離
- ✅ **ログイン時の自動表示対象設定**
  - Firestoreの`users`コレクションから名前を取得（ハードコード廃止）
  - ログイン後、自動的に自分を表示対象に設定
- ✅ **カラム削除時のタスクチェック修正**
  - 他ユーザーのタスクをカウント対象外に
- ✅ **統計情報のフィルター連動修正**
  - 表示対象切替時に統計も連動して更新

### 2025-12-11 完了
- ✅ **TERRAブランディング適用**
- ✅ **ボタン色統一**
- ✅ **レガシーコード削除（54行削減）**
- ✅ **楽観的UI更新実装（パフォーマンス改善）**
- ✅ **×ボタンの視認性改善**
- ✅ **タスク作成時のアニメーション**
- ✅ **統計サマリーのカード化**
- ✅ **期限切れ・今日期限カードのクリック機能**

### 2025-12-09以前 完了
- ✅ プロジェクトカラム移動ボタン不具合修正
- ✅ Slack通知のカラム名表示修正
- ✅ 「ゴミ箱」→「アーカイブ」リネーム
- ✅ 「営業タスク管理」→「Kanban Work」に変更
- ✅ OCR機能完全削除
- ✅ ヘルプモーダル実装
- ✅ kanbanColumns Firestore移行完了
- ✅ プロジェクトタスク増殖バグ修正
- ✅ Firebase認証・ログイン問題解決

---

## 🔴🔴🔴 最優先（至上命題）

### 1. LocalStorage完全脱却プロジェクト **(3-5時間)**

**ユーザーコメント**: 「至上命題です。超重要です。」
**⚠️ 注意**: これまでエラーが多かった箇所のため、慎重に対応すること。

| データ | Firebase | LocalStorage | 状態 |
|-------|----------|--------------|------|
| タスク | ✅ | ❌ | 完全移行済み |
| プロジェクト | ✅ | ❌ | 完全移行済み |
| ユーザー情報 | ✅ | ⚠️ キャッシュ | 移行済み |
| kanbanColumns | ✅ | ⚠️ キャッシュ | 移行済み（12/15ユーザー別対応） |
| currentSession | ❌ | ✅ | **要移行** |
| taskTemplates | ❌ | ✅ | **要移行** |
| recurringTemplates | ❌ | ✅ | **要移行** |

---

## 🟡 中優先度

### 2. チュートリアル機能の完成 **(2-3時間)**
- **初出**: v009（2025-12-09）
- ヘルプモーダルは実装済みだが内容の充実が必要
- 最後に対応予定

---

## 📋 延期・保留

### 全員表示でユーザーごとにグループ化表示
- 検討中だが優先度低

### カラムシステム再設計
- **設計書**: `design/column-system-redesign-2025-12-02.md`
- **状態**: 設計完了、実装延期
- **実装タイミング**: カラム名変更で統計が壊れる問題が発生した時
- **現状の保護**: ID完全一致で認識（isDoneColumn, isTrashColumn）

---

## 📊 作業時間見積もり

| 優先度 | 時間 |
|-------|------|
| 🔴🔴🔴 最優先（至上命題） | 3-5時間 |
| 🟡 中優先度 | 2-3時間 |
| **総合計** | **約5-8時間** |

---

## ⚠️ デプロイフロー

1. **開発環境でテスト**: `http://localhost:3000/index-kanban.html`
2. **ユーザーのGOを待つ**
3. **本番デプロイ**: `git push origin main`

---

## 📁 関連ファイル

### コード
- **メインコード**: `sales-task-core/index-kanban.html`
- **マイページ**: `sales-task-core/my-profile.html`
- **Firebase設定**: `sales-task-core/firebase-config-auth-fix-20250819-132508.js`
- **Slack通知**: `sales-task-core/slack-proxy.js`
- **TERRAロゴ**: `sales-task-core/terra-logo-white.png`

### 設計書
- `design/column-system-redesign-2025-12-02.md` - カラムシステム再設計
- `design/user-column-customization-2025-12-08.md` - ユーザーカラムカスタマイズ

### エラーログ
- `error-logs/2025-12-15-username-mismatch-bug.md` - ユーザー名不一致問題
- `error-logs/2025-12-08-ocr-feature-removal.md`
- `error-logs/2025-12-08-trash-to-archive-rename.md`
- `error-logs/2025-12-04-project-task-duplication-fix.md`
- `error-logs/2025-12-04-wrong-dev-url-repeated-mistake.md`
- `error-logs/2025-12-02-statistics-logic-column-detection-fix.md`

---

## バージョン履歴

| バージョン | 日付 | 主な変更 |
|-----------|------|---------|
| v001-v003 | 11/19-20 | 初期要件定義 |
| v004 | 11/20 | 包括的要件定義（22項目） |
| v005 | 12/01 | UI/UX Phase 1完了 |
| v006 | 12/01-02 | ユーザーフィードバック反映、統計ロジック修正 |
| v007 | 12/04 | タスク増殖バグ修正、カラム保護強化 |
| v008 | 12/08 | アーカイブ化、Kanban Work命名、ヘルプ実装 |
| v009 | 12/09 | 全タスク棚卸し、設計書未実装分追加 |
| v010 | 12/11 | TERRAブランディング、楽観的UI更新、レガシーコード削除 |
| **v011** | **12/15** | **ユーザーごとカラムカスタマイズ、ログイン時自動表示対象設定** |

---

**最終更新**: 2025-12-15
**作成者**: Claude Code
**ステータス**: ✅ 最新版
